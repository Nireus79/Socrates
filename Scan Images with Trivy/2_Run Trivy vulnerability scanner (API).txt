2025-12-31T22:20:59.1985808Z ##[group]Run aquasecurity/trivy-action@master
2025-12-31T22:20:59.1986495Z with:
2025-12-31T22:20:59.1987208Z   image-ref: ghcr.io/nireus79/socrates/api:master
ghcr.io/nireus79/socrates/api:latest
ghcr.io/nireus79/socrates/api:master-3a5c55d
2025-12-31T22:20:59.1987807Z   format: sarif
2025-12-31T22:20:59.1988044Z   output: trivy-api-results.sarif
2025-12-31T22:20:59.1988347Z   severity: CRITICAL,HIGH
2025-12-31T22:20:59.1988584Z   scan-type: image
2025-12-31T22:20:59.1988819Z   scan-ref: .
2025-12-31T22:20:59.1989042Z   ignore-unfixed: false
2025-12-31T22:20:59.1989303Z   vuln-type: os,library
2025-12-31T22:20:59.1989608Z   cache-dir: /home/runner/work/Socrates/Socrates/.cache/trivy
2025-12-31T22:20:59.1989944Z   list-all-pkgs: false
2025-12-31T22:20:59.1990181Z   version: v0.68.1
2025-12-31T22:20:59.1990403Z   cache: true
2025-12-31T22:20:59.1990618Z   skip-setup-trivy: false
2025-12-31T22:20:59.1991079Z   token-setup-trivy: ***
2025-12-31T22:20:59.1991579Z ##[endgroup]
2025-12-31T22:20:59.2147550Z ##[group]Run aquasecurity/setup-trivy@e6c2c5e321ed9123bda567646e2f96565e34abe1
2025-12-31T22:20:59.2148034Z with:
2025-12-31T22:20:59.2148246Z   version: v0.68.1
2025-12-31T22:20:59.2148462Z   cache: true
2025-12-31T22:20:59.2148845Z   token: ***
2025-12-31T22:20:59.2149079Z   path: $HOME/.local/bin
2025-12-31T22:20:59.2149360Z   github-server-url: https://github.com
2025-12-31T22:20:59.2149867Z ##[endgroup]
2025-12-31T22:20:59.2183159Z ##[group]Run echo "dir=$HOME/.local/bin/trivy-bin" >> $GITHUB_OUTPUT
2025-12-31T22:20:59.2183731Z [36;1mecho "dir=$HOME/.local/bin/trivy-bin" >> $GITHUB_OUTPUT[0m
2025-12-31T22:20:59.2220876Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-12-31T22:20:59.2221288Z ##[endgroup]
2025-12-31T22:20:59.2480453Z ##[group]Run actions/cache@0400d5f644dc74513175e3cd8d07132dd4860809
2025-12-31T22:20:59.2480995Z with:
2025-12-31T22:20:59.2481353Z   path: /home/runner/.local/bin/trivy-bin
2025-12-31T22:20:59.2481731Z   key: trivy-binary-v0.68.1-Linux-X64
2025-12-31T22:20:59.2482305Z   enableCrossOsArchive: false
2025-12-31T22:20:59.2482739Z   fail-on-cache-miss: false
2025-12-31T22:20:59.2483049Z   lookup-only: false
2025-12-31T22:20:59.2483404Z   save-always: false
2025-12-31T22:20:59.2483700Z ##[endgroup]
2025-12-31T22:20:59.4950623Z Cache hit for: trivy-binary-v0.68.1-Linux-X64
2025-12-31T22:20:59.8240948Z Received 43282186 of 43282186 (100.0%), 146.9 MBs/sec
2025-12-31T22:20:59.8241880Z Cache Size: ~41 MB (43282186 B)
2025-12-31T22:20:59.8273204Z [command]/usr/bin/tar -xf /home/runner/work/_temp/4fe1430c-0ed3-4ed8-b61b-9c27b7ea1803/cache.tzst -P -C /home/runner/work/Socrates/Socrates --use-compress-program unzstd
2025-12-31T22:21:00.0792921Z Cache restored successfully
2025-12-31T22:21:00.0991259Z Cache restored from key: trivy-binary-v0.68.1-Linux-X64
2025-12-31T22:21:00.1118367Z ##[group]Run echo /home/runner/.local/bin/trivy-bin >> $GITHUB_PATH
2025-12-31T22:21:00.1118840Z [36;1mecho /home/runner/.local/bin/trivy-bin >> $GITHUB_PATH[0m
2025-12-31T22:21:00.1151112Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-12-31T22:21:00.1151490Z ##[endgroup]
2025-12-31T22:21:00.1239031Z ##[group]Run echo "date=$(date +'%Y-%m-%d')" >> $GITHUB_OUTPUT
2025-12-31T22:21:00.1239455Z [36;1mecho "date=$(date +'%Y-%m-%d')" >> $GITHUB_OUTPUT[0m
2025-12-31T22:21:00.1272744Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-12-31T22:21:00.1273131Z ##[endgroup]
2025-12-31T22:21:00.1395658Z ##[group]Run actions/cache@0400d5f644dc74513175e3cd8d07132dd4860809
2025-12-31T22:21:00.1396007Z with:
2025-12-31T22:21:00.1396244Z   path: /home/runner/work/Socrates/Socrates/.cache/trivy
2025-12-31T22:21:00.1396541Z   key: cache-trivy-2025-12-31
2025-12-31T22:21:00.1396779Z   restore-keys: cache-trivy-
2025-12-31T22:21:00.1397267Z   enableCrossOsArchive: false
2025-12-31T22:21:00.1397550Z   fail-on-cache-miss: false
2025-12-31T22:21:00.1397773Z   lookup-only: false
2025-12-31T22:21:00.1397971Z   save-always: false
2025-12-31T22:21:00.1398162Z ##[endgroup]
2025-12-31T22:21:00.3342892Z Cache hit for: cache-trivy-2025-12-31
2025-12-31T22:21:00.7549190Z Received 57557246 of 57557246 (100.0%), 144.8 MBs/sec
2025-12-31T22:21:00.7550282Z Cache Size: ~55 MB (57557246 B)
2025-12-31T22:21:00.7579300Z [command]/usr/bin/tar -xf /home/runner/work/_temp/3e94230c-2603-43a3-9462-b51803e08299/cache.tzst -P -C /home/runner/work/Socrates/Socrates --use-compress-program unzstd
2025-12-31T22:21:01.8821552Z Cache restored successfully
2025-12-31T22:21:01.9010579Z Cache restored from key: cache-trivy-2025-12-31
2025-12-31T22:21:01.9121982Z ##[group]Run echo "$GITHUB_ACTION_PATH" >> $GITHUB_PATH
2025-12-31T22:21:01.9122392Z [36;1mecho "$GITHUB_ACTION_PATH" >> $GITHUB_PATH[0m
2025-12-31T22:21:01.9155041Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-12-31T22:21:01.9155407Z env:
2025-12-31T22:21:01.9155759Z   GITHUB_ACTION_PATH: /home/runner/work/_actions/aquasecurity/trivy-action/master
2025-12-31T22:21:01.9156177Z ##[endgroup]
2025-12-31T22:21:01.9229842Z ##[group]Run rm -f trivy_envs.txt
2025-12-31T22:21:01.9230168Z [36;1mrm -f trivy_envs.txt[0m
2025-12-31T22:21:01.9230414Z [36;1mtouch trivy_envs.txt[0m
2025-12-31T22:21:01.9259660Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-12-31T22:21:01.9260036Z ##[endgroup]
2025-12-31T22:21:01.9351794Z ##[group]Run # Note: There is currently no way to distinguish between undefined variables and empty strings in GitHub Actions.
2025-12-31T22:21:01.9352917Z [36;1m# Note: There is currently no way to distinguish between undefined variables and empty strings in GitHub Actions.[0m
2025-12-31T22:21:01.9353523Z [36;1m# This limitation affects how we handle default values and empty inputs.[0m
2025-12-31T22:21:01.9354041Z [36;1m# For more information, see: https://github.com/actions/runner/issues/924[0m
2025-12-31T22:21:01.9354417Z [36;1m[0m
2025-12-31T22:21:01.9354764Z [36;1m# The following logic implements the configuration priority described in the README:[0m
2025-12-31T22:21:01.9355169Z [36;1m#[0m
2025-12-31T22:21:01.9355350Z [36;1m# Inputs[0m
2025-12-31T22:21:01.9355570Z [36;1m# Environment Variables[0m
2025-12-31T22:21:01.9355819Z [36;1m# Config File[0m
2025-12-31T22:21:01.9356033Z [36;1m# Defaults[0m
2025-12-31T22:21:01.9356227Z [36;1m#[0m
2025-12-31T22:21:01.9356607Z [36;1m# As noted above defaults are awkward to handle as GitHub Actions will inject those values as the input[0m
2025-12-31T22:21:01.9357526Z [36;1m# if the caller doesn't provide them, thus if the input matches the default we don't set it as we[0m
2025-12-31T22:21:01.9358191Z [36;1m# can't tell the difference.  Plus if we did set it when it was the default value then it could potentially [0m
2025-12-31T22:21:01.9358872Z [36;1m# override an external environment variable, or something in the callers configuration file, which then wouldn't [0m
2025-12-31T22:21:01.9359438Z [36;1m# match the configuration priority that is documented.[0m
2025-12-31T22:21:01.9359760Z [36;1mset_env_var_if_provided() {[0m
2025-12-31T22:21:01.9360020Z [36;1m  local var_name="$1"[0m
2025-12-31T22:21:01.9360276Z [36;1m  local input_value="$2"[0m
2025-12-31T22:21:01.9360530Z [36;1m  local default_value="$3"[0m
2025-12-31T22:21:01.9360766Z [36;1m[0m
2025-12-31T22:21:01.9361039Z [36;1m  if [ ! -z "$input_value" ] && [ "$input_value" != "$default_value" ]; then[0m
2025-12-31T22:21:01.9361480Z [36;1m    # If action was provided with explicit input by the caller set that[0m
2025-12-31T22:21:01.9361901Z [36;1m    echo "export $var_name=$input_value" >> trivy_envs.txt[0m
2025-12-31T22:21:01.9362206Z [36;1m  fi[0m
2025-12-31T22:21:01.9362386Z [36;1m}[0m
2025-12-31T22:21:01.9362556Z [36;1m[0m
2025-12-31T22:21:01.9362827Z [36;1m# Set environment variables, handling those with default values[0m
2025-12-31T22:21:01.9363375Z [36;1m# cf. https://aquasecurity.github.io/trivy/latest/docs/configuration/#environment-variables[0m
2025-12-31T22:21:01.9363870Z [36;1mset_env_var_if_provided "TRIVY_INPUT" "" ""[0m
2025-12-31T22:21:01.9364198Z [36;1mset_env_var_if_provided "TRIVY_EXIT_CODE" "" ""[0m
2025-12-31T22:21:01.9364727Z [36;1mset_env_var_if_provided "TRIVY_IGNORE_UNFIXED" "false" "false"[0m
2025-12-31T22:21:01.9365162Z [36;1mset_env_var_if_provided "TRIVY_PKG_TYPES" "os,library" "os,library"[0m
2025-12-31T22:21:01.9365698Z [36;1mset_env_var_if_provided "TRIVY_SEVERITY" "CRITICAL,HIGH" "UNKNOWN,LOW,MEDIUM,HIGH,CRITICAL"[0m
2025-12-31T22:21:01.9366195Z [36;1mset_env_var_if_provided "TRIVY_FORMAT" "sarif" "table"[0m
2025-12-31T22:21:01.9366551Z [36;1mset_env_var_if_provided "TRIVY_TEMPLATE" "" ""[0m
2025-12-31T22:21:01.9366939Z [36;1mset_env_var_if_provided "TRIVY_OUTPUT" "trivy-api-results.sarif" ""[0m
2025-12-31T22:21:01.9367601Z [36;1mset_env_var_if_provided "TRIVY_SKIP_DIRS" "" ""[0m
2025-12-31T22:21:01.9367939Z [36;1mset_env_var_if_provided "TRIVY_SKIP_FILES" "" ""[0m
2025-12-31T22:21:01.9368269Z [36;1mset_env_var_if_provided "TRIVY_TIMEOUT" "" ""[0m
2025-12-31T22:21:01.9368605Z [36;1mset_env_var_if_provided "TRIVY_IGNORE_POLICY" "" ""[0m
2025-12-31T22:21:01.9368936Z [36;1mset_env_var_if_provided "TRIVY_QUIET" "" ""[0m
2025-12-31T22:21:01.9369289Z [36;1mset_env_var_if_provided "TRIVY_LIST_ALL_PKGS" "false" "false"[0m
2025-12-31T22:21:01.9369653Z [36;1mset_env_var_if_provided "TRIVY_SCANNERS" "" ""[0m
2025-12-31T22:21:01.9369965Z [36;1mset_env_var_if_provided "TRIVY_CONFIG" "" ""[0m
2025-12-31T22:21:01.9370416Z [36;1mset_env_var_if_provided "TRIVY_TF_VARS" "" ""[0m
2025-12-31T22:21:01.9370746Z [36;1mset_env_var_if_provided "TRIVY_DOCKER_HOST" "" ""[0m
2025-12-31T22:21:01.9400355Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-12-31T22:21:01.9400701Z ##[endgroup]
2025-12-31T22:21:01.9473553Z ##[group]Run entrypoint.sh
2025-12-31T22:21:01.9473823Z [36;1mentrypoint.sh[0m
2025-12-31T22:21:01.9502512Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-12-31T22:21:01.9502847Z env:
2025-12-31T22:21:01.9503036Z   INPUT_SCAN_TYPE: image
2025-12-31T22:21:01.9503588Z   INPUT_IMAGE_REF: ghcr.io/nireus79/socrates/api:master
ghcr.io/nireus79/socrates/api:latest
ghcr.io/nireus79/socrates/api:master-3a5c55d
2025-12-31T22:21:01.9504175Z   INPUT_SCAN_REF: .
2025-12-31T22:21:01.9504383Z   INPUT_TRIVYIGNORES: 
2025-12-31T22:21:01.9504593Z   INPUT_GITHUB_PAT: 
2025-12-31T22:21:01.9504814Z   INPUT_LIMIT_SEVERITIES_FOR_SARIF: 
2025-12-31T22:21:01.9505151Z   TRIVY_CACHE_DIR: /home/runner/work/Socrates/Socrates/.cache/trivy
2025-12-31T22:21:01.9505495Z ##[endgroup]
2025-12-31T22:21:01.9567637Z Building SARIF report with all severities
2025-12-31T22:21:01.9568268Z Running Trivy with options: trivy image ghcr.io/nireus79/socrates/api:master
2025-12-31T22:21:01.9568799Z ghcr.io/nireus79/socrates/api:latest
2025-12-31T22:21:01.9569197Z ghcr.io/nireus79/socrates/api:master-3a5c55d
2025-12-31T22:21:02.0170740Z 2025-12-31T22:21:02Z	INFO	[vuln] Vulnerability scanning is enabled
2025-12-31T22:21:02.0172905Z 2025-12-31T22:21:02Z	INFO	[secret] Secret scanning is enabled
2025-12-31T22:21:02.0173761Z 2025-12-31T22:21:02Z	INFO	[secret] If your scanning is slow, please try '--scanners vuln' to disable secret scanning
2025-12-31T22:21:02.0174985Z 2025-12-31T22:21:02Z	INFO	[secret] Please see https://trivy.dev/docs/v0.68/guide/scanner/secret#recommendation for faster secret detection
2025-12-31T22:21:02.0244109Z 2025-12-31T22:21:02Z	FATAL	Fatal error	run error: image scan error: scan error: unable to initialize a scan service: unable to initialize artifact: unable to initialize container image: failed to parse the image name: could not parse reference: ghcr.io/nireus79/socrates/api:master
2025-12-31T22:21:02.0245833Z ghcr.io/nireus79/socrates/api:latest
2025-12-31T22:21:02.0246262Z ghcr.io/nireus79/socrates/api:master-3a5c55d
2025-12-31T22:21:02.0308515Z ##[error]Process completed with exit code 1.
2025-12-31T22:21:02.0332002Z ##[group]Run rm -f trivy_envs.txt
2025-12-31T22:21:02.0332318Z [36;1mrm -f trivy_envs.txt[0m
2025-12-31T22:21:02.0364533Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-12-31T22:21:02.0364874Z ##[endgroup]
