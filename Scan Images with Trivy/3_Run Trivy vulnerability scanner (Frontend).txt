2025-12-31T22:21:02.0591389Z ##[group]Run aquasecurity/trivy-action@master
2025-12-31T22:21:02.0591704Z with:
2025-12-31T22:21:02.0592260Z   image-ref: ghcr.io/nireus79/socrates/frontend:master
ghcr.io/nireus79/socrates/frontend:latest
ghcr.io/nireus79/socrates/frontend:master-3a5c55d
2025-12-31T22:21:02.0592875Z   format: sarif
2025-12-31T22:21:02.0593104Z   output: trivy-frontend-results.sarif
2025-12-31T22:21:02.0593366Z   severity: CRITICAL,HIGH
2025-12-31T22:21:02.0593585Z   scan-type: image
2025-12-31T22:21:02.0593774Z   scan-ref: .
2025-12-31T22:21:02.0593960Z   ignore-unfixed: false
2025-12-31T22:21:02.0594168Z   vuln-type: os,library
2025-12-31T22:21:02.0594442Z   cache-dir: /home/runner/work/Socrates/Socrates/.cache/trivy
2025-12-31T22:21:02.0594770Z   list-all-pkgs: false
2025-12-31T22:21:02.0594976Z   version: v0.68.1
2025-12-31T22:21:02.0595162Z   cache: true
2025-12-31T22:21:02.0595349Z   skip-setup-trivy: false
2025-12-31T22:21:02.0595709Z   token-setup-trivy: ***
2025-12-31T22:21:02.0595934Z ##[endgroup]
2025-12-31T22:21:02.0653970Z ##[group]Run aquasecurity/setup-trivy@e6c2c5e321ed9123bda567646e2f96565e34abe1
2025-12-31T22:21:02.0654346Z with:
2025-12-31T22:21:02.0654526Z   version: v0.68.1
2025-12-31T22:21:02.0654710Z   cache: true
2025-12-31T22:21:02.0655005Z   token: ***
2025-12-31T22:21:02.0655203Z   path: $HOME/.local/bin
2025-12-31T22:21:02.0655631Z   github-server-url: https://github.com
2025-12-31T22:21:02.0655900Z ##[endgroup]
2025-12-31T22:21:02.0673416Z ##[group]Run echo "dir=$HOME/.local/bin/trivy-bin" >> $GITHUB_OUTPUT
2025-12-31T22:21:02.0673852Z [36;1mecho "dir=$HOME/.local/bin/trivy-bin" >> $GITHUB_OUTPUT[0m
2025-12-31T22:21:02.0703885Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-12-31T22:21:02.0704221Z ##[endgroup]
2025-12-31T22:21:02.0798743Z ##[group]Run actions/cache@0400d5f644dc74513175e3cd8d07132dd4860809
2025-12-31T22:21:02.0799089Z with:
2025-12-31T22:21:02.0799299Z   path: /home/runner/.local/bin/trivy-bin
2025-12-31T22:21:02.0799572Z   key: trivy-binary-v0.68.1-Linux-X64
2025-12-31T22:21:02.0799851Z   enableCrossOsArchive: false
2025-12-31T22:21:02.0800089Z   fail-on-cache-miss: false
2025-12-31T22:21:02.0800325Z   lookup-only: false
2025-12-31T22:21:02.0800564Z   save-always: false
2025-12-31T22:21:02.0800762Z ##[endgroup]
2025-12-31T22:21:02.2842328Z Cache hit for: trivy-binary-v0.68.1-Linux-X64
2025-12-31T22:21:02.6014234Z Received 43282186 of 43282186 (100.0%), 146.4 MBs/sec
2025-12-31T22:21:02.6014982Z Cache Size: ~41 MB (43282186 B)
2025-12-31T22:21:02.6048202Z [command]/usr/bin/tar -xf /home/runner/work/_temp/b120527d-c8a2-4990-ba2a-bd1ba9596eff/cache.tzst -P -C /home/runner/work/Socrates/Socrates --use-compress-program unzstd
2025-12-31T22:21:02.8964210Z Cache restored successfully
2025-12-31T22:21:02.9128994Z Cache restored from key: trivy-binary-v0.68.1-Linux-X64
2025-12-31T22:21:02.9239204Z ##[group]Run echo /home/runner/.local/bin/trivy-bin >> $GITHUB_PATH
2025-12-31T22:21:02.9239675Z [36;1mecho /home/runner/.local/bin/trivy-bin >> $GITHUB_PATH[0m
2025-12-31T22:21:02.9272383Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-12-31T22:21:02.9272724Z ##[endgroup]
2025-12-31T22:21:02.9346402Z ##[group]Run echo "date=$(date +'%Y-%m-%d')" >> $GITHUB_OUTPUT
2025-12-31T22:21:02.9346798Z [36;1mecho "date=$(date +'%Y-%m-%d')" >> $GITHUB_OUTPUT[0m
2025-12-31T22:21:02.9375493Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-12-31T22:21:02.9375834Z ##[endgroup]
2025-12-31T22:21:02.9471829Z ##[group]Run actions/cache@0400d5f644dc74513175e3cd8d07132dd4860809
2025-12-31T22:21:02.9472165Z with:
2025-12-31T22:21:02.9472407Z   path: /home/runner/work/Socrates/Socrates/.cache/trivy
2025-12-31T22:21:02.9472721Z   key: cache-trivy-2025-12-31
2025-12-31T22:21:02.9472963Z   restore-keys: cache-trivy-
2025-12-31T22:21:02.9473209Z   enableCrossOsArchive: false
2025-12-31T22:21:02.9473446Z   fail-on-cache-miss: false
2025-12-31T22:21:02.9473672Z   lookup-only: false
2025-12-31T22:21:02.9473875Z   save-always: false
2025-12-31T22:21:02.9474072Z ##[endgroup]
2025-12-31T22:21:03.1401462Z Cache hit for: cache-trivy-2025-12-31
2025-12-31T22:21:03.4934981Z Received 57557246 of 57557246 (100.0%), 172.6 MBs/sec
2025-12-31T22:21:03.4936134Z Cache Size: ~55 MB (57557246 B)
2025-12-31T22:21:03.4966962Z [command]/usr/bin/tar -xf /home/runner/work/_temp/04199702-b592-4632-8214-d474b1c0fbcf/cache.tzst -P -C /home/runner/work/Socrates/Socrates --use-compress-program unzstd
2025-12-31T22:21:04.7429227Z Cache restored successfully
2025-12-31T22:21:04.7623528Z Cache restored from key: cache-trivy-2025-12-31
2025-12-31T22:21:04.7739524Z ##[group]Run echo "$GITHUB_ACTION_PATH" >> $GITHUB_PATH
2025-12-31T22:21:04.7739904Z [36;1mecho "$GITHUB_ACTION_PATH" >> $GITHUB_PATH[0m
2025-12-31T22:21:04.7772520Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-12-31T22:21:04.7772875Z env:
2025-12-31T22:21:04.7773211Z   GITHUB_ACTION_PATH: /home/runner/work/_actions/aquasecurity/trivy-action/master
2025-12-31T22:21:04.7773615Z ##[endgroup]
2025-12-31T22:21:04.7843367Z ##[group]Run rm -f trivy_envs.txt
2025-12-31T22:21:04.7843674Z [36;1mrm -f trivy_envs.txt[0m
2025-12-31T22:21:04.7843926Z [36;1mtouch trivy_envs.txt[0m
2025-12-31T22:21:04.7872724Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-12-31T22:21:04.7873079Z ##[endgroup]
2025-12-31T22:21:04.7963343Z ##[group]Run # Note: There is currently no way to distinguish between undefined variables and empty strings in GitHub Actions.
2025-12-31T22:21:04.7964414Z [36;1m# Note: There is currently no way to distinguish between undefined variables and empty strings in GitHub Actions.[0m
2025-12-31T22:21:04.7965104Z [36;1m# This limitation affects how we handle default values and empty inputs.[0m
2025-12-31T22:21:04.7965683Z [36;1m# For more information, see: https://github.com/actions/runner/issues/924[0m
2025-12-31T22:21:04.7966109Z [36;1m[0m
2025-12-31T22:21:04.7966499Z [36;1m# The following logic implements the configuration priority described in the README:[0m
2025-12-31T22:21:04.7966964Z [36;1m#[0m
2025-12-31T22:21:04.7967429Z [36;1m# Inputs[0m
2025-12-31T22:21:04.7967668Z [36;1m# Environment Variables[0m
2025-12-31T22:21:04.7967943Z [36;1m# Config File[0m
2025-12-31T22:21:04.7968194Z [36;1m# Defaults[0m
2025-12-31T22:21:04.7968412Z [36;1m#[0m
2025-12-31T22:21:04.7968842Z [36;1m# As noted above defaults are awkward to handle as GitHub Actions will inject those values as the input[0m
2025-12-31T22:21:04.7969538Z [36;1m# if the caller doesn't provide them, thus if the input matches the default we don't set it as we[0m
2025-12-31T22:21:04.7970181Z [36;1m# can't tell the difference.  Plus if we did set it when it was the default value then it could potentially [0m
2025-12-31T22:21:04.7970873Z [36;1m# override an external environment variable, or something in the callers configuration file, which then wouldn't [0m
2025-12-31T22:21:04.7971451Z [36;1m# match the configuration priority that is documented.[0m
2025-12-31T22:21:04.7971788Z [36;1mset_env_var_if_provided() {[0m
2025-12-31T22:21:04.7972060Z [36;1m  local var_name="$1"[0m
2025-12-31T22:21:04.7972307Z [36;1m  local input_value="$2"[0m
2025-12-31T22:21:04.7972565Z [36;1m  local default_value="$3"[0m
2025-12-31T22:21:04.7972810Z [36;1m[0m
2025-12-31T22:21:04.7973085Z [36;1m  if [ ! -z "$input_value" ] && [ "$input_value" != "$default_value" ]; then[0m
2025-12-31T22:21:04.7973537Z [36;1m    # If action was provided with explicit input by the caller set that[0m
2025-12-31T22:21:04.7973977Z [36;1m    echo "export $var_name=$input_value" >> trivy_envs.txt[0m
2025-12-31T22:21:04.7974286Z [36;1m  fi[0m
2025-12-31T22:21:04.7974470Z [36;1m}[0m
2025-12-31T22:21:04.7974647Z [36;1m[0m
2025-12-31T22:21:04.7974928Z [36;1m# Set environment variables, handling those with default values[0m
2025-12-31T22:21:04.7975485Z [36;1m# cf. https://aquasecurity.github.io/trivy/latest/docs/configuration/#environment-variables[0m
2025-12-31T22:21:04.7975983Z [36;1mset_env_var_if_provided "TRIVY_INPUT" "" ""[0m
2025-12-31T22:21:04.7976330Z [36;1mset_env_var_if_provided "TRIVY_EXIT_CODE" "" ""[0m
2025-12-31T22:21:04.7976871Z [36;1mset_env_var_if_provided "TRIVY_IGNORE_UNFIXED" "false" "false"[0m
2025-12-31T22:21:04.7977526Z [36;1mset_env_var_if_provided "TRIVY_PKG_TYPES" "os,library" "os,library"[0m
2025-12-31T22:21:04.7978066Z [36;1mset_env_var_if_provided "TRIVY_SEVERITY" "CRITICAL,HIGH" "UNKNOWN,LOW,MEDIUM,HIGH,CRITICAL"[0m
2025-12-31T22:21:04.7978572Z [36;1mset_env_var_if_provided "TRIVY_FORMAT" "sarif" "table"[0m
2025-12-31T22:21:04.7978939Z [36;1mset_env_var_if_provided "TRIVY_TEMPLATE" "" ""[0m
2025-12-31T22:21:04.7979364Z [36;1mset_env_var_if_provided "TRIVY_OUTPUT" "trivy-frontend-results.sarif" ""[0m
2025-12-31T22:21:04.7979786Z [36;1mset_env_var_if_provided "TRIVY_SKIP_DIRS" "" ""[0m
2025-12-31T22:21:04.7980142Z [36;1mset_env_var_if_provided "TRIVY_SKIP_FILES" "" ""[0m
2025-12-31T22:21:04.7980485Z [36;1mset_env_var_if_provided "TRIVY_TIMEOUT" "" ""[0m
2025-12-31T22:21:04.7980828Z [36;1mset_env_var_if_provided "TRIVY_IGNORE_POLICY" "" ""[0m
2025-12-31T22:21:04.7981175Z [36;1mset_env_var_if_provided "TRIVY_QUIET" "" ""[0m
2025-12-31T22:21:04.7981541Z [36;1mset_env_var_if_provided "TRIVY_LIST_ALL_PKGS" "false" "false"[0m
2025-12-31T22:21:04.7981928Z [36;1mset_env_var_if_provided "TRIVY_SCANNERS" "" ""[0m
2025-12-31T22:21:04.7982384Z [36;1mset_env_var_if_provided "TRIVY_CONFIG" "" ""[0m
2025-12-31T22:21:04.7982709Z [36;1mset_env_var_if_provided "TRIVY_TF_VARS" "" ""[0m
2025-12-31T22:21:04.7983045Z [36;1mset_env_var_if_provided "TRIVY_DOCKER_HOST" "" ""[0m
2025-12-31T22:21:04.8011795Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-12-31T22:21:04.8012136Z ##[endgroup]
2025-12-31T22:21:04.8083077Z ##[group]Run entrypoint.sh
2025-12-31T22:21:04.8083343Z [36;1mentrypoint.sh[0m
2025-12-31T22:21:04.8111946Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-12-31T22:21:04.8112287Z env:
2025-12-31T22:21:04.8112482Z   INPUT_SCAN_TYPE: image
2025-12-31T22:21:04.8113114Z   INPUT_IMAGE_REF: ghcr.io/nireus79/socrates/frontend:master
ghcr.io/nireus79/socrates/frontend:latest
ghcr.io/nireus79/socrates/frontend:master-3a5c55d
2025-12-31T22:21:04.8113776Z   INPUT_SCAN_REF: .
2025-12-31T22:21:04.8113994Z   INPUT_TRIVYIGNORES: 
2025-12-31T22:21:04.8114214Z   INPUT_GITHUB_PAT: 
2025-12-31T22:21:04.8114439Z   INPUT_LIMIT_SEVERITIES_FOR_SARIF: 
2025-12-31T22:21:04.8114803Z   TRIVY_CACHE_DIR: /home/runner/work/Socrates/Socrates/.cache/trivy
2025-12-31T22:21:04.8115145Z ##[endgroup]
2025-12-31T22:21:04.8176900Z Building SARIF report with all severities
2025-12-31T22:21:04.8177985Z Running Trivy with options: trivy image ghcr.io/nireus79/socrates/frontend:master
2025-12-31T22:21:04.8178773Z ghcr.io/nireus79/socrates/frontend:latest
2025-12-31T22:21:04.8179361Z ghcr.io/nireus79/socrates/frontend:master-3a5c55d
2025-12-31T22:21:04.8784047Z 2025-12-31T22:21:04Z	INFO	[vuln] Vulnerability scanning is enabled
2025-12-31T22:21:04.8784904Z 2025-12-31T22:21:04Z	INFO	[secret] Secret scanning is enabled
2025-12-31T22:21:04.8785823Z 2025-12-31T22:21:04Z	INFO	[secret] If your scanning is slow, please try '--scanners vuln' to disable secret scanning
2025-12-31T22:21:04.8787281Z 2025-12-31T22:21:04Z	INFO	[secret] Please see https://trivy.dev/docs/v0.68/guide/scanner/secret#recommendation for faster secret detection
2025-12-31T22:21:04.8800528Z 2025-12-31T22:21:04Z	FATAL	Fatal error	run error: image scan error: scan error: unable to initialize a scan service: unable to initialize artifact: unable to initialize container image: failed to parse the image name: could not parse reference: ghcr.io/nireus79/socrates/frontend:master
2025-12-31T22:21:04.8802374Z ghcr.io/nireus79/socrates/frontend:latest
2025-12-31T22:21:04.8803261Z ghcr.io/nireus79/socrates/frontend:master-3a5c55d
2025-12-31T22:21:04.8848439Z ##[error]Process completed with exit code 1.
2025-12-31T22:21:04.8866872Z ##[group]Run rm -f trivy_envs.txt
2025-12-31T22:21:04.8867424Z [36;1mrm -f trivy_envs.txt[0m
2025-12-31T22:21:04.8900925Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-12-31T22:21:04.8901497Z ##[endgroup]
