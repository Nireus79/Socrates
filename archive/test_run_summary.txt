Tests completed with return code: 1
Last 50 lines of output:
    _os.unlink(path)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\themi\\AppData\\Local\\Temp\\tmpdar7_jvn\\vectors.db\\chroma.sqlite3'
----------------------------- Captured log setup ------------------------------
DEBUG    asyncio:proactor_events.py:634 Using proactor: IocpProactor
DEBUG    asyncio:proactor_events.py:634 Using proactor: IocpProactor
DEBUG    socratic_system.database.project_db_v2.ProjectDatabaseV2:project_db_v2.py:128 Foreign keys enabled for this connection
INFO     socratic_system.database.project_db_v2.ProjectDatabaseV2:project_db_v2.py:94 V2 schema initialized with foreign keys enabled
INFO     socrates.database.migrations:migration_runner.py:233 Applying GitHub import tables migration (add_github_import_tables.sql)...
DEBUG    socrates.database.migrations:migration_runner.py:62 Executing: -- Migration: Add GitHub Import and Code Validatio...
DEBUG    socrates.database.migrations:migration_runner.py:62 Executing: CREATE INDEX IF NOT EXISTS idx_project_files_proje...
DEBUG    socrates.database.migrations:migration_runner.py:62 Executing: CREATE INDEX IF NOT EXISTS idx_project_files_langu...
DEBUG    socrates.database.migrations:migration_runner.py:62 Executing: CREATE INDEX IF NOT EXISTS idx_project_files_path
...
DEBUG    socrates.database.migrations:migration_runner.py:62 Executing: -- ===============================================...
DEBUG    socrates.database.migrations:migration_runner.py:62 Executing: CREATE INDEX IF NOT EXISTS idx_repo_metadata_url
 ...
DEBUG    socrates.database.migrations:migration_runner.py:62 Executing: CREATE INDEX IF NOT EXISTS idx_repo_metadata_owner...
DEBUG    socrates.database.migrations:migration_runner.py:62 Executing: CREATE INDEX IF NOT EXISTS idx_repo_metadata_langu...
DEBUG    socrates.database.migrations:migration_runner.py:62 Executing: -- ===============================================...
DEBUG    socrates.database.migrations:migration_runner.py:62 Executing: CREATE INDEX IF NOT EXISTS idx_validation_project
...
DEBUG    socrates.database.migrations:migration_runner.py:62 Executing: CREATE INDEX IF NOT EXISTS idx_validation_date
   ...
DEBUG    socrates.database.migrations:migration_runner.py:62 Executing: CREATE INDEX IF NOT EXISTS idx_validation_status
 ...
DEBUG    socrates.database.migrations:migration_runner.py:62 Executing: -- ===============================================...
DEBUG    socrates.database.migrations:migration_runner.py:62 Executing: ALTER TABLE projects_v2 ADD COLUMN repository_impo...
DEBUG    socrates.database.migrations:migration_runner.py:62 Executing: -- ===============================================...
DEBUG    socrates.database.migrations:migration_runner.py:62 Executing: CREATE INDEX IF NOT EXISTS idx_projects_repository...
DEBUG    socrates.database.migrations:migration_runner.py:62 Executing: -- ===============================================...
INFO     socrates.database.migrations:migration_runner.py:69 Successfully applied migration: add_github_import_tables.sql
INFO     socrates.database.migrations:migration_runner.py:228 Claude auth method column already applied, skipping
INFO     socrates.database.migrations:migration_runner.py:246 All migrations applied successfully. Status: {'github_import_tables': True, 'users_claude_auth_method': True}
INFO     socratic_system.database.project_db_v2.ProjectDatabaseV2:project_db_v2.py:108 Migrations check passed: All migrations applied successfully. Status: {'github_import_tables': True, 'users_claude_auth_method': True}
INFO     socrates.database.vector:vector_db.py:45 Initializing vector database: C:\Users\themi\AppData\Local\Temp\tmpdar7_jvn\vectors.db
DEBUG    chromadb.config:config.py:363 Starting component System
DEBUG    chromadb.config:config.py:363 Starting component Posthog
DEBUG    socrates.database.vector:vector_db.py:48 ChromaDB client created
DEBUG    socrates.database.vector:vector_db.py:54 Vector collection 'socratic_knowledge' initialized
INFO     socrates.database.vector:vector_db.py:60 Vector database initialized successfully (embedding model will load on first use)
INFO     socrates.database.vector:vector_db.py:65 Embedding and search caches initialized (Phase 3)
DEBUG    socrates.events:event_emitter.py:142 Event: system.initialized - {'version': '0.5.0', 'data_dir': 'C:\\Users\\themi\\.socrates', 'model': 'claude-haiku-4-5-20251001', 'timestamp': '2025-12-18T19:29:36.001480'}
DEBUG    socrates.events:event_emitter.py:142 Event: log.info - {'message': 'Loading knowledge base...', 'timestamp': '2025-12-18T19:29:36.001480'}
------------------------------ Captured log call ------------------------------
DEBUG    socrates.events:event_emitter.py:142 Event: token.usage - {'operation': 'generate_socratic_question_async', 'input_tokens': 10, 'output_tokens': 20, 'total_tokens': 30, 'cost_estimate': 0.00033, 'timestamp': '2025-12-18T19:29:36.007479'}
=========================== short test summary info ===========================
ERROR tests\async\test_async_agents.py::TestAsyncClaude::test_generate_socratic_question_async - PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\themi\\AppData\\Local\\Temp\\tmpdar7_jvn\\vectors.db\\chroma.sqlite3'
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!
================== 107 passed, 1 warning, 1 error in 15.40s ===================

